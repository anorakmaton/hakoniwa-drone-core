# Rotor Component Specification

## Overview

The `RotorDynamics` component simulates the behavior of individual rotors on the drone, converting control inputs into rotor speed, thrust, and torque. It accounts for battery voltage effects and provides parameters for tuning rotor performance.

## Input

*   **Control Input**: A double value representing the desired control signal for the rotor (typically a duty cycle from 0.0 to 1.0).
*   **Battery Voltage (vbat)**: The current voltage supplied by the battery, which affects rotor performance when battery dynamics are enabled.

## Output

*   **Rotor Speed**: The current rotational speed of the rotor in radians per second.
*   **Thrust**: The thrust generated by the rotor in Newtons (N).
*   **Torque**: The anti-torque generated by the rotor in Newton-meters (Nm).
*   **Current**: The electrical current drawn by the rotor in Amperes (A) when battery dynamics are enabled.
*   **PWM Duty Rate**: The effective PWM duty cycle applied to the motor (0.0 to 1.0).

## External Parameters

### Rotor Parameters
-   **`param_rad_per_sec_max`**: Maximum rotational speed of the rotor in radians per second.
-   **`param_tr`**: Time constant related to rotor speed response.
-   **`param_kr`**: Gain constant related to rotor speed response.

### Battery Model Constants (if battery dynamics are enabled)
-   **`R`**: Resistance of the motor.
-   **`Cq`**: Torque constant of the motor.
-   **`Ct`**: Thrust constant of the motor.
-   **`K`**: Back electromotive force constant.
-   **`D`**: Drag constant.
-   **`J`**: Moment of inertia of the rotor.

## Operational Details

-   **Rotor Speed Calculation**: The rotor speed is calculated based on the control input, and optionally, the battery voltage and motor constants. It simulates the acceleration and deceleration of the rotor.
-   **Thrust and Torque Generation**: Thrust and anti-torque are calculated based on the current rotor speed and the rotor's physical constants (`Ct`, `Cq`).
-   **Current Consumption**: When battery dynamics are enabled, the electrical current drawn by the motor is calculated based on battery voltage, rotor speed, and motor constants.
-   **Speed Limiting**: The rotor speed is capped at `param_rad_per_sec_max` and prevented from going below zero.
-   **Reset Functionality**: The `reset()` method initializes the rotor speed, current, and other internal states to zero.
